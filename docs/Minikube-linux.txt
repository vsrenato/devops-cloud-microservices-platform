Instalando o Minikube no Linux
Vamos aprender a instalar a versÃ£o mais recente do Minikube no Ubuntu Linux 22.04 LTS, especificamente com o VirtualBox v7.0. Esta instalaÃ§Ã£o pressupÃµe que nenhum outro software de isolamento esteja instalado em nossa estaÃ§Ã£o de trabalho Linux, como KVM2, QEMU, Docker Engine ou Podman, que o Minikube possa usar como driver.

OBSERVAÃ‡ÃƒO : Para outras distribuiÃ§Ãµes ou versÃµes do sistema operacional Linux, versÃµes do VirtualBox e Minikube, as etapas de instalaÃ§Ã£o podem variar! Consulte a instalaÃ§Ã£o do Minikube para obter instruÃ§Ãµes especÃ­ficas!

Verifique o suporte Ã  virtualizaÃ§Ã£o no seu sistema operacional Linux em um terminal (uma saÃ­da nÃ£o vazia indica virtualizaÃ§Ã£o suportada):

$ grep -E --color 'vmx|svm' /proc/cpuinfo

A maneira mais fÃ¡cil de baixar e instalar o hipervisor VirtualBox para Linux Ã© atravÃ©s do site oficial de downloads. O VirtualBox estÃ¡ disponÃ­vel para diversas distribuiÃ§Ãµes Linux, como Oracle Linux, RHEL, CentOS 7, Ubuntu, Debian, openSUSE e Fedora.

O Minikube pode ser facilmente baixado e instalado em um terminal. A versÃ£o mais recente ou uma versÃ£o especÃ­fica disponÃ­vel na pÃ¡gina de lanÃ§amentos do Minikube pode ser instalada executando os seguintes comandos. Embora esses comandos de instalaÃ§Ã£o reflitam o guia de instalaÃ§Ã£o oficial no momento da atualizaÃ§Ã£o do conteÃºdo do curso, eles podem mudar em um futuro prÃ³ximo como parte do crescimento contÃ­nuo do Kubernetes. Ã‰ altamente recomendÃ¡vel consultar o guia de instalaÃ§Ã£o oficial para Linux > x86-64 > EstÃ¡vel ao tentar a instalaÃ§Ã£o, para garantir que os repositÃ³rios de pacotes mais atualizados sejam usados â€‹â€‹no processo. Abaixo, apresentamos a opÃ§Ã£o de download binÃ¡rio , uma abordagem de instalaÃ§Ã£o neutra em relaÃ§Ã£o Ã  distribuiÃ§Ã£o:

$ curl -LO \
h ttps://github.com/kubernetes/minikube/releases/latest/download/minikube-linux-amd64

$ sudo install minikube-linux-amd64 /usr/local/bin/minikube && rm minikube-linux-amd64

OBSERVAÃ‡ÃƒO : Substituir /latest/  por uma versÃ£o especÃ­fica, como  /v1.31.2/  , farÃ¡ o download da versÃ£o especificada do Minikube.

Inicie o Minikube. Em um terminal, podemos iniciar o Minikube com o comando minikube start , que inicializa um cluster de nÃ³ Ãºnico com a versÃ£o estÃ¡vel mais recente do Kubernetes suportada. Para uma versÃ£o especÃ­fica do Kubernetes, a opÃ§Ã£o --kubernetes-version pode ser usada como minikube start --kubernetes-version=v1.27.1  (onde "latest" Ã© o valor padrÃ£o e aceitÃ¡vel da versÃ£o, e "stable" tambÃ©m Ã© aceitÃ¡vel). Caso existam outros drivers de virtualizaÃ§Ã£o candidatos para o Minikube na estaÃ§Ã£o de trabalho, Ã© recomendÃ¡vel fornecer o driver desejado com a opÃ§Ã£o --driver=virtualbox . OpÃ§Ãµes de inicializaÃ§Ã£o mais avanÃ§adas serÃ£o exploradas posteriormente neste capÃ­tulo:

$ minikube start --driver=virtualbox

ğŸ˜„ minikube v1.32.0 no Ubuntu 22.04
âœ¨ Usando o driver do VirtualBox com base na configuraÃ§Ã£o do usuÃ¡rio
ğŸ’¿ Baixando a imagem de inicializaÃ§Ã£o da VM ...
   > minikube-v1.32.1-amd64.iso....: 65 B / 65 B [---------] 100,00% ? p/s 0s
   > minikube-v1.32.1-amd64.iso: 292,96 MiB / 292,96 MiB 100,00% 31,34 MiB p
ğŸ‘ Iniciando o nÃ³ do plano de controle minikube no cluster minikube
ğŸ’¾ Baixando o Kubernetes v1.28.3 preload ...
   > preloaded-images-k8s-v18-v1...: 403,35 MiB / 403,35 MiB 100,00% 32,19 M
ğŸ”¥ Criando VM virtualbox (CPUs=2, MemÃ³ria=6000MB, Disco=20000MB) ...
ğŸ³ Preparando o Kubernetes v1.28.3 no Docker 24.0.7 ...
   â–ª Gerando certificados e chaves ...
   â–ª Inicializando o plano de controle ...
   â–ª Configurando regras RBAC...
ğŸ”— Configurando a ponte CNI (Container Networking Interface)...
ğŸ” Verificando componentes do Kubernetes...
   â–ª Usando a imagem gcr.io/k8s-minikube/storage-provisioner:v5
ğŸŒŸ Complementos habilitados: storage-provisioner, default-storageclass
ğŸ’¡ kubectl nÃ£o encontrado. Se precisar, tente: 'minikube kubectl -- get pods -A'
ğŸ„ Pronto! O kubectl agora estÃ¡ configurado para usar o cluster "minikube" e o namespace "default" por padrÃ£o.

NOTA : Uma mensagem de erro que diz "NÃ£o foi possÃ­vel escolher um driver padrÃ£o..." significa que o Minikube nÃ£o conseguiu localizar nenhum dos hipervisores ou runtimes suportados. A recomendaÃ§Ã£o Ã© instalar ou reinstalar uma ferramenta de isolamento desejada e garantir que seu executÃ¡vel seja encontrado no PATH padrÃ£o da sua distribuiÃ§Ã£o de sistema operacional.

NOTA: Uma mensagem de erro que diz "O mÃ³dulo do kernel vboxdrv nÃ£o estÃ¡ carregado" significa que um mÃ³dulo crÃ­tico do kernel do VirtualBox pode nÃ£o estar disponÃ­vel. Primeiro, tente reinstalar o VirtualBox na estaÃ§Ã£o de trabalho. Em seguida, tente instalar um compilador C que pode estar ausente na sua estaÃ§Ã£o de trabalho e, em seguida, compile o mÃ³dulo do kernel. Para o sistema operacional Ubuntu 22.04 LTS, o compilador gcc necessÃ¡rio pode ser baixado e instalado em https://packages.ubuntu.com/jammy/amd64/gcc-12/download . O mÃ³dulo do kernel pode ser compilando com o comando sudo /sbin/vboxconfig . ApÃ³s uma reconstruÃ§Ã£o bem-sucedida, tente iniciar o minikube novamente com o VirtualBox usando o comando acima.

Verifique o status. Com o comando minikube status , exibimos o status do cluster Minikube:

$ status do minikube

minikube
tipo: Plano de controle
host: Executando
kubelet: Executando
apiserver: Executando
kubeconfig: Configurado

Pare o Minikube. Com o comando minikube stop , podemos parar o Minikube. Este comando interrompe todos os aplicativos em execuÃ§Ã£o no Minikube, interrompe com seguranÃ§a o cluster e a VM do VirtualBox, preservando nosso trabalho atÃ© decidirmos reiniciar o cluster do Minikube, preservando a VM do Minikube:

$ minikube stop

âœ‹ Parando o nÃ³ "minikube" ...
ğŸ›‘ 1 nÃ³ parado.

Quando for a hora de executar o cluster novamente, basta executar o comando minikube start (a opÃ§Ã£o de driver nÃ£o Ã© necessÃ¡ria) e ele reiniciarÃ¡ o cluster Minikube inicializado anteriormente.

Remover o Minikube. O comando minikube delete remove completamente o Minikube e a VM do Minikube. Este comando deve ser tentado somente quando o cluster Minikube for desativado. Todo o trabalho serÃ¡ perdido apÃ³s a conclusÃ£o deste comando:

$ minikube delete

ğŸ”¥ Excluindo "minikube" no VirtualBox ...
ğŸ’€ Removido todos os vestÃ­gios do cluster "minikube".